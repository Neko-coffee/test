# ğŸ”¥ AQR é…ç½®å‚æ•°å®Œå…¨æŒ‡å—

## ğŸ“‹ ç›®å½•

1. [è¶…å‚æ•°æ§åˆ¶ç´¢å¼•](#è¶…å‚æ•°æ§åˆ¶ç´¢å¼•)
2. [åŠŸèƒ½å¼€å…³ä½ç½®](#åŠŸèƒ½å¼€å…³ä½ç½®)
3. [è¯¦ç»†å‚æ•°è¯´æ˜](#è¯¦ç»†å‚æ•°è¯´æ˜)

## ğŸ“Œ è¶…å‚æ•°æ§åˆ¶ç´¢å¼•

### **1. AQR æ€»å¼€å…³**
**ä½ç½®**ï¼šç¬¬ 65 è¡Œ  
**å‚æ•°**ï¼š`enable_aqr=True`  
**ä½œç”¨**ï¼šAQR åŠŸèƒ½çš„å…¨å±€å¼€å…³  
**å¯é€‰å€¼**ï¼š
- `True`ï¼šå¯ç”¨ AQRï¼ˆä½¿ç”¨ AQR æƒé‡å›¾æ¸²æŸ“ï¼‰
- `False`ï¼šå…³é—­ AQRï¼ˆæ ‡å‡† CMT æ¨¡å¼ï¼‰

---

### **2. çª—å£å¤§å°æ§åˆ¶**  
**ä½ç½®**ï¼šç¬¬ 79 è¡Œ  
**å‚æ•°**ï¼š`window_sizes=[8, 5]`  
**ä½œç”¨**ï¼šå®šä¹‰å±€éƒ¨æ³¨æ„åŠ›çª—å£å¤§å°  
**æ ¼å¼**ï¼š`[camera_window, lidar_window]`  
**è¯´æ˜**ï¼š
- `camera_window=8`ï¼šç›¸æœºç‰¹å¾çš„å±€éƒ¨çª—å£ï¼ˆé€è§†ç‰¹å¾ï¼‰
- `lidar_window=5`ï¼šLiDARç‰¹å¾çš„å±€éƒ¨çª—å£ï¼ˆBEVç‰¹å¾ï¼‰
- çª—å£è¶Šå°ï¼Œæ³¨æ„åŠ›è¶Šå±€éƒ¨ï¼Œè®¡ç®—è¶Šå¿«ï¼Œä½†å¯èƒ½ä¸¢å¤±é•¿è·ç¦»ä¾èµ–
- çª—å£è¶Šå¤§ï¼Œæ³¨æ„åŠ›è¶Šå…¨å±€ï¼Œè®¡ç®—è¶Šæ…¢ï¼Œä½†æ•æ‰æ›´å¤šä¸Šä¸‹æ–‡

**æ¨èå€¼**ï¼š
- `800Ã—320` åˆ†è¾¨ç‡ï¼š`[8, 5]`
- `1600Ã—640` åˆ†è¾¨ç‡ï¼š`[15, 5]`

---

### **3. é«˜æ–¯çª—å£å¼€å…³** ğŸ”¥ğŸ”¥ğŸ”¥ **æœ€é‡è¦ï¼**
**ä½ç½®**ï¼šç¬¬ 189 è¡Œ  
**å‚æ•°**ï¼š`use_gaussian_window=False`  
**ä½œç”¨**ï¼šé€‰æ‹©ä½¿ç”¨å‡åŒ€çª—å£è¿˜æ˜¯é«˜æ–¯è¡°å‡çª—å£  
**å¯é€‰å€¼**ï¼š
- `False`ï¼šå‡åŒ€çª—å£ï¼ˆæƒé‡åœ¨çª—å£å†…ç›¸ç­‰ï¼‰
- `True`ï¼šé«˜æ–¯è¡°å‡çª—å£ï¼ˆæƒé‡ä¸­å¿ƒé«˜ï¼Œè¾¹ç¼˜ä½ï¼‰

#### **é«˜æ–¯çª—å£å‚æ•°**
**ä½ç½®**ï¼šç¬¬ 190 è¡Œ  
**å‚æ•°**ï¼š`gaussian_sigma=2.0`  
**ä½œç”¨**ï¼šé«˜æ–¯æ ¸çš„æ ‡å‡†å·®ï¼ˆæ§åˆ¶è¡°å‡é€Ÿåº¦ï¼‰  
**è¯´æ˜**ï¼š
- ä»…å½“ `use_gaussian_window=True` æ—¶ç”Ÿæ•ˆ
- å€¼è¶Šå°ï¼šè¡°å‡è¶Šå¿«ï¼Œæ³¨æ„åŠ›è¶Šé›†ä¸­åœ¨ä¸­å¿ƒ
- å€¼è¶Šå¤§ï¼šè¡°å‡è¶Šæ…¢ï¼Œæ³¨æ„åŠ›åˆ†å¸ƒæ›´å‡åŒ€
- **æ¨èå€¼**ï¼š
  - `800Ã—320` åˆ†è¾¨ç‡ï¼š`2.0`
  - `1600Ã—640` åˆ†è¾¨ç‡ï¼š`2.5`

---

### **4. æ¸²æŸ“æ–¹æ³•å¼€å…³**
**ä½ç½®**ï¼šç¬¬ 122 è¡Œ  
**å‚æ•°**ï¼š`render_method='gaussian'`  
**ä½œç”¨**ï¼šé€‰æ‹©æƒé‡å›¾çš„æ¸²æŸ“æ–¹æ³•  
**å¯é€‰å€¼**ï¼š
- `'gaussian'`ï¼šé«˜æ–¯æ•£å¸ƒï¼ˆå¹³æ»‘ï¼Œæ¨èï¼‰
- `'bilinear'`ï¼šåŒçº¿æ€§æ’å€¼ï¼ˆå¹³æ»‘ä½†è®¡ç®—ç¨æ…¢ï¼‰
- `'direct'`ï¼šç›´æ¥èµ‹å€¼ï¼ˆæœ€å¿«ä½†å¯èƒ½æœ‰çªå˜ï¼‰
- `'distance_weighted'`ï¼šè·ç¦»åŠ æƒï¼ˆè€ƒè™‘ç©ºé—´è·ç¦»ï¼‰

#### **é«˜æ–¯æ¸²æŸ“å‚æ•°**
**ä½ç½®**ï¼šç¬¬ 127 è¡Œ  
**å‚æ•°**ï¼š`gaussian_sigma=1.0`  
**ä½œç”¨**ï¼šé«˜æ–¯æ•£å¸ƒçš„æ ‡å‡†å·®  
**è¯´æ˜**ï¼š
- ä»…å½“ `render_method='gaussian'` æ—¶ç”Ÿæ•ˆ
- å€¼è¶Šå°ï¼šæ•£å¸ƒè¶Šé›†ä¸­ï¼Œæƒé‡å›¾è¶Šå°–é”
- å€¼è¶Šå¤§ï¼šæ•£å¸ƒè¶Šåˆ†æ•£ï¼Œæƒé‡å›¾è¶Šå¹³æ»‘

---

### **5. bias_scale æ§åˆ¶**
**ä½ç½®**ï¼šç¬¬ 180-183 è¡Œ  
**å‚æ•°ç»„**ï¼š
```python
bias_scale=2.5          # åˆå§‹å€¼
learnable_scale=True    # æ˜¯å¦å¯å­¦ä¹ 
min_scale=0.5          # æœ€å°å€¼
max_scale=5.0          # æœ€å¤§å€¼
```

**è¯¦ç»†è¯´æ˜**ï¼š

#### **bias_scaleï¼ˆç¬¬180è¡Œï¼‰**
- **ä½œç”¨**ï¼šæ³¨æ„åŠ›åç½®çš„å¼ºåº¦
- **åˆå§‹å€¼**ï¼š`2.5`ï¼ˆæ¨èï¼‰
- **è°ƒå‚å»ºè®®**ï¼š
  - å¢å¤§ï¼šæ³¨æ„åŠ›æ›´åå‘ AQR ç”Ÿæˆçš„æƒé‡
  - å‡å°ï¼šæ³¨æ„åŠ›æ›´åå‘åŸå§‹æ³¨æ„åŠ›æœºåˆ¶

#### **learnable_scaleï¼ˆç¬¬181è¡Œï¼‰** ğŸ”¥ğŸ”¥ğŸ”¥ **å…³é”®ï¼**
- **ä½œç”¨**ï¼šæ§åˆ¶ `bias_scale` æ˜¯å¦åœ¨è®­ç»ƒä¸­æ›´æ–°
- **å¯é€‰å€¼**ï¼š
  - `True`ï¼šå¯å­¦ä¹ ï¼Œä¼šéšæ¢¯åº¦ä¸‹é™æ›´æ–°ï¼ˆæ¨èï¼‰
  - `False`ï¼šå›ºå®šå€¼ï¼Œå§‹ç»ˆä¿æŒåˆå§‹å€¼
- **ä½ çš„åŸé—®é¢˜**ï¼šå°±æ˜¯è¿™ä¸ªé—®é¢˜ï¼è®¾ä¸º `True` å°±èƒ½ä¿è¯ `bias_scale` æ­£å¸¸æ›´æ–°

#### **min_scaleï¼ˆç¬¬182è¡Œï¼‰**
- **ä½œç”¨**ï¼šé˜²æ­¢ `bias_scale` é€€åŒ–åˆ°å¤ªå°çš„å€¼
- **é»˜è®¤å€¼**ï¼š`0.5`

#### **max_scaleï¼ˆç¬¬183è¡Œï¼‰**
- **ä½œç”¨**ï¼šé˜²æ­¢ `bias_scale` å¯¼è‡´ softmax é¥±å’Œ
- **é»˜è®¤å€¼**ï¼š`5.0`

---

### **6. è°ƒè¯•æ§åˆ¶**
**ä½ç½®**ï¼šç¬¬ 66 è¡Œã€ç¬¬ 195-196 è¡Œ  
**å‚æ•°ç»„**ï¼š
```python
# ç¬¬ 66 è¡Œ
debug_mode=True

# ç¬¬ 195-196 è¡Œ
debug_print=True           # å¯ç”¨è°ƒè¯•æ‰“å°
print_interval=1000        # æ‰“å°é—´éš”
```

**è¯´æ˜**ï¼š
- `debug_mode=True`ï¼šå¯ç”¨è°ƒè¯•æ¨¡å¼ï¼ˆç”Ÿäº§ç¯å¢ƒå»ºè®®è®¾ä¸º `False`ï¼‰
- `debug_print=True`ï¼šæ‰“å° bias ç»Ÿè®¡ä¿¡æ¯ï¼ˆæŸ¥çœ‹ bias_scale æ˜¯å¦æ›´æ–°ï¼‰
- `print_interval=1000`ï¼šæ¯ 1000 ä¸ª iteration æ‰“å°ä¸€æ¬¡

---

## ğŸ“Š å‚æ•°å½±å“çŸ©é˜µ

### **é«˜æ–¯çª—å£çš„å½±å“**
| å‚æ•° | å‡åŒ€çª—å£ (False) | é«˜æ–¯çª—å£ (True) |
|---|---|---|
| **æ³¨æ„åŠ›åˆ†å¸ƒ** | çª—å£å†…å‡åŒ€ | ä¸­å¿ƒé«˜è¾¹ç¼˜ä½ |
| **è®¡ç®—é€Ÿåº¦** | å¿« | ç¨æ…¢ï¼ˆè®¡ç®—é«˜æ–¯ï¼‰ |
| **æ•ˆæœ** | æ¸…æ™°è¾¹ç•Œ | æ›´å¹³æ»‘è‡ªç„¶ |
| **æ¨èåœºæ™¯** | ç‰©ä½“è¾¹ç•Œæ˜æ˜¾ | éœ€è¦å¹³æ»‘è¿‡æ¸¡ |

### **bias_scale çš„å½±å“**
| å€¼ | æ•ˆæœ | æ¨èåœºæ™¯ |
|---|---|---|
| **1.0** | å¼±åç½® | å¼€å§‹è®­ç»ƒ |
| **2.5** | ä¸­ç­‰åç½®ï¼ˆæ¨èï¼‰ | é»˜è®¤é…ç½® |
| **4.0** | å¼ºåç½® | éœ€è¦æ›´å¼ºè°ƒ AQR æ—¶ |
| **>5.0** | å¯èƒ½é¥±å’Œ | ä¸æ¨è |

---

## ğŸ¯ å¿«é€Ÿé…ç½®æ¨¡æ¿

### **æ¨¡æ¿1ï¼šå¿«é€Ÿå®éªŒï¼ˆä¸æ¨èï¼‰**
```python
enable_aqr=True
use_gaussian_window=False        # å…³é—­é«˜æ–¯ï¼ˆæ›´å¿«ï¼‰
render_method='direct'           # ç›´æ¥æ¸²æŸ“ï¼ˆæœ€å¿«ï¼‰
bias_scale=1.0                  # å°åç½®
```

### **æ¨¡æ¿2ï¼šå¹³è¡¡é…ç½®ï¼ˆæ¨èï¼‰**
```python
enable_aqr=True
use_gaussian_window=False        # å‡åŒ€çª—å£ï¼ˆå¤Ÿç”¨ï¼‰
render_method='gaussian'         # é«˜æ–¯æ¸²æŸ“ï¼ˆå¹³æ»‘ï¼‰
bias_scale=2.5                  # ä¸­ç­‰åç½®
```

### **æ¨¡æ¿3ï¼šæœ€ä½³æ•ˆæœï¼ˆä½†ç¨æ…¢ï¼‰**
```python
enable_aqr=True
use_gaussian_window=True         # é«˜æ–¯çª—å£ï¼ˆæœ€å¹³æ»‘ï¼‰
gaussian_sigma=2.0
render_method='gaussian'         # é«˜æ–¯æ¸²æŸ“
bias_scale=2.5                  # ä¸­ç­‰åç½®
```

---

## ğŸ”¥ å¸¸è§é—®é¢˜

### **Q1ï¼šbias_scale ä¸æ›´æ–°ï¼Ÿ**
**A**ï¼šæ£€æŸ¥ `learnable_scale=True`ï¼ˆç¬¬181è¡Œï¼‰

### **Q2ï¼šé«˜æ–¯çª—å£ä½•æ—¶ä½¿ç”¨ï¼Ÿ**
**A**ï¼šå½“éœ€è¦å¹³æ»‘çš„æ³¨æ„åŠ›åˆ†å¸ƒæ—¶ï¼Œæ¨è `use_gaussian_window=True`

### **Q3ï¼šçª—å£å¤§å°å¦‚ä½•é€‰æ‹©ï¼Ÿ**
**A**ï¼šæ ¹æ®ç‰¹å¾å›¾å°ºå¯¸ï¼š
- å°ç‰¹å¾å›¾ï¼ˆ128Ã—128ï¼‰ï¼š`[8, 5]`
- å¤§ç‰¹å¾å›¾ï¼ˆ180Ã—180ï¼‰ï¼š`[15, 5]`

### **Q4ï¼šå“ªä¸ªå‚æ•°æœ€é‡è¦ï¼Ÿ**
**A**ï¼š
1. `learnable_scale=True`ï¼ˆä¿è¯æ›´æ–°ï¼‰
2. `use_gaussian_window`ï¼ˆé€‰æ‹©çª—å£ç±»å‹ï¼‰
3. `bias_scale=2.5`ï¼ˆåˆå§‹å¼ºåº¦ï¼‰

---

## ğŸ“ æ€»ç»“

### **ä½ æé—®çš„ç­”æ¡ˆ**
1. **bias_scale æ”¯ä¸æ”¯æŒæ²¡å…³ç³»**ï¼šâœ… æ­£ç¡®ï¼AQR æƒé‡ç”Ÿæˆå™¨ä¸éœ€è¦ bias_scale
2. **é«˜æ–¯çª—å£å¼€å…³**ï¼š`use_gaussian_window`ï¼ˆç¬¬189è¡Œï¼‰
3. **AQR å¼€å…³**ï¼š`enable_aqr`ï¼ˆç¬¬65è¡Œï¼‰

### **å…³é”®å‘ç°**
- âœ… `bias_scale` ç”± `attention_bias_config` æ§åˆ¶ï¼Œä¸æ˜¯ AQR æƒé‡ç”Ÿæˆå™¨
- âœ… é«˜æ–¯çª—å£éœ€è¦å•ç‹¬å¼€å¯ï¼š`use_gaussian_window=True`
- âœ… æœ€é‡è¦çš„å‚æ•°ï¼š`learnable_scale=True`ï¼ˆä¿è¯æ›´æ–°ï¼‰



